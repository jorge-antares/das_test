PLANE CRASHES DATASET — FIELD CLEANING NOTES
=============================================

Source table : plane_crashes_data  (rawdata/plane_crashes_data.db)
Output table : data                (output/cleaned_plane_crashes.db)

General rule applied to every text field
-----------------------------------------
- Leading and trailing whitespace is stripped.
- The value '?' (unknown marker used throughout the raw data) is converted to NULL.
- Empty strings are converted to NULL.


──────────────────────────────────────────────────────────────────────────────
FIELD: date
──────────────────────────────────────────────────────────────────────────────
Raw format : DD-Mon-YY  (e.g. '17-Nov-78', '03-Jun-01')
Output     : ISO 8601 TEXT  'YYYY-MM-DD'

Changes:
  '17-Nov-78'  →  '1978-11-17'
  '03-Jun-01'  →  '2001-06-03'
  '?'          →  NULL

Note: Python's strptime maps two-digit years 00–68 to 2000–2068 and 69–99 to
1969–1999. Any resulting year beyond 2025 is shifted back 100 years to avoid 
placing historical crashes in the future.


──────────────────────────────────────────────────────────────────────────────
FIELD: time
──────────────────────────────────────────────────────────────────────────────
Raw format : free-text local time, e.g. '1730', '17:30', 'c1730', 'c 08:15'
Output     : TEXT  'HH:MM' (24-hour), or NULL

Changes:
  '1730'    →  '17:30'   (bare 4-digit integer)
  '0930'    →  '09:30'
  'c1730'   →  '17:30'   (approximate prefix 'c' stripped)
  'c 08:15' →  '08:15'   (approximate prefix 'c ' stripped)
  '9:5'     →  NULL      (invalid minutes)
  '?'       →  NULL


──────────────────────────────────────────────────────────────────────────────
FIELD: location  →  split into two output columns: location + country
──────────────────────────────────────────────────────────────────────────────
Raw format : free-text, typically 'City/Region, State/Country'
Output     : location TEXT  — everything before the final comma
             country  TEXT  — inferred country name

Changes:
  'Near Atlanta, Georgia'       →  location='Near Atlanta',   country='United States'
  'London, England'             →  location='London',         country='United Kingdom'
  'Paris, France'               →  location='Paris',          country='France'
  'Moscow, Russia'              →  location='Moscow',         country='Russia'
  'Russia'                      →  location=NULL,             country='Russia'
  'Atlantic Ocean'              →  location=NULL,             country=NULL
  '?'                           →  location=NULL,             country=NULL

Rules for country detection:
  - Last comma-separated token is the country candidate.
  - US state names (e.g. 'Texas') and 2-letter codes (e.g. 'TX') → 'United States'.
  - UK constituents (England, Scotland, Wales, Northern Ireland, etc.) → 'United Kingdom'.
  - Geographic features (ocean, sea, gulf, strait, bay, etc.) → country=NULL.
  - Single-token entries with no geographic word → treated as bare country name.


──────────────────────────────────────────────────────────────────────────────
FIELD: operator
──────────────────────────────────────────────────────────────────────────────
Raw format : free-text airline / operator name
Output     : TEXT, or NULL

Changes:
  'American Airlines'          →  'American Airlines'      (unchanged)
  'Turkish Air ForceC-47'      →  'Turkish Air Force'      (run-on aircraft designator stripped)
  'Boeing KC-135E'             →  NULL                     (aircraft type in wrong column)
  'Lockheed AC-130H Hercules'  →  NULL                     (aircraft type in wrong column)
  'Bristol 170 Freighter 31M'  →  NULL                     (aircraft type in wrong column)
  '46826/109'                  →  NULL                     (serial/registration code, not an operator)
  '?'                          →  NULL


──────────────────────────────────────────────────────────────────────────────
FIELD: flight_no
──────────────────────────────────────────────────────────────────────────────
Raw format : free-text flight number
Output     : TEXT (dashes removed), or NULL

Changes:
  'UA-123'   →  'UA123'     (dashes removed)
  '686 / -'  →  '686'       (unknown sub-part stripped)
  '?/8301'   →  NULL        (starts with '?')
  '-'        →  NULL        (bare unknown marker)
  '10-Jan'   →  NULL        (misplaced date entry)
  'Charter'  →  NULL        (operation type, not a flight number)
  '?'        →  NULL


──────────────────────────────────────────────────────────────────────────────
FIELD: route
──────────────────────────────────────────────────────────────────────────────
Raw format : free-text origin–destination or operation description
Output     : TEXT (normalised), or NULL

Changes:
  'New York - London'                     →  'New York - London'    (unchanged)
  'New  York  -  London'                  →  'New York - London'    (whitespace collapsed)
  'Tauranga.'                             →  'Tauranga'             (trailing period removed)
  'Training - Montreal - Ottawa'          →  'Montreal - Ottawa'    (operation prefix stripped)
  'Positioning - San Jose - Honolulu'     →  'San Jose - Honolulu'  (operation prefix stripped)
  'Sightseeing'                           →  NULL                   (operation label only, no route)
  'Test Flight'                           →  NULL                   (operation label only, no route)
  'VP-BPS'                                →  NULL                   (aircraft registration code)
  '?'                                     →  NULL

Operation-type prefixes that are stripped or nullified:
  Positioning, Training, Sightseeing, Test, Reconnaissance, Survey,
  Shuttle, Skydiving, Search mission, Service mission, Traffic reporting,
  Practice maneuvers, Radio surveillance mission, Transporting troops.


──────────────────────────────────────────────────────────────────────────────
FIELD: ac_type  (aircraft type)
──────────────────────────────────────────────────────────────────────────────
Raw format : free-text aircraft model, sometimes with parenthetical notes
Output     : TEXT (cleaned), or NULL

Changes:
  'Douglas DC-3 (aircraft)'     →  'Douglas DC-3'         (parenthetical removed)
  'Boeing 737 (freighter)'      →  'Boeing 737'           (parenthetical removed)
  'Aero Commander  520'         →  'Aero Commander 520'   (extra spaces collapsed)
  'Bell UH-1H / Bell UH-1H'    →  'Bell UH-1H / Bell UH-1H'  (mid-air collision, kept as-is)
  '?'                           →  NULL


──────────────────────────────────────────────────────────────────────────────
FIELD: registration
──────────────────────────────────────────────────────────────────────────────
Raw format : ICAO registration, sometimes with spacing/formatting issues
Output     : TEXT (normalised), or NULL

Changes:
  'B- 305'         →  'B-305'        (space around hyphen removed)
  'PT - CIH'       →  'PT-CIH'       (spaces around hyphen removed)
  'N 79069'        →  'N79069'       (errant space in US N-number removed)
  'NC 21714'       →  'NC21714'      (errant space in US NC prefix removed)
  'CCCP 11000'     →  'CCCP-11000'   (space replaced with hyphen for multi-letter prefix)
  'N11360/N4862F'  →  'N11360 / N4862F'  (mid-air collision pair reformatted)
  '12-May'         →  NULL           (misplaced date entry)
  '1/2/2003'       →  NULL           (misplaced date entry)
  '?'              →  NULL


──────────────────────────────────────────────────────────────────────────────
FIELD: cn_ln  (construction / line number)
──────────────────────────────────────────────────────────────────────────────
Raw format : serial/construction number, sometimes with annotations or date mix-ups
Output     : TEXT (hyphens removed, normalised), or NULL

Changes:
  '1533 (KLM-1)'       →  '1533'               (parenthetical annotation removed)
  '2528 /?'            →  '2528'               (unknown line-number suffix stripped)
  '18365 /'            →  '18365'              (trailing slash artefact removed)
  '19643-11'           →  '1964311'            (hyphens removed)
  '19643/11 / 20400/157' →  '1964311 / 20400157'  (mid-air collision pair, hyphens removed)
  '2-Jan'              →  NULL                 (misplaced date entry)
  '?'                  →  NULL


──────────────────────────────────────────────────────────────────────────────
FIELD: aboard  →  split into three output columns
──────────────────────────────────────────────────────────────────────────────
Raw format : 'N ▸ (passengers:X ▸ crew:Y)'  or plain integer
Output     : aboard_total INTEGER, aboard_passengers INTEGER, aboard_crew INTEGER

Changes:
  '152 ▸ (passengers:138 ▸ crew:14)'  →  total=152, passengers=138, crew=14
  '152 ▸ (passengers:? ▸ crew:14)'    →  total=152, passengers=NULL, crew=14
  '40'                                →  total=40,  passengers=NULL, crew=NULL
  '?'                                 →  total=NULL, passengers=NULL, crew=NULL


──────────────────────────────────────────────────────────────────────────────
FIELD: fatalities  →  split into three output columns
──────────────────────────────────────────────────────────────────────────────
Raw format : same format as 'aboard'
Output     : fatalities_aboard INTEGER, fatalities_passengers INTEGER, fatalities_crew INTEGER

Changes: same rules as 'aboard' above.

An additional derived column fatalities_total is computed as:
  fatalities_total = fatalities_aboard + ground  (NULLs treated as 0)


──────────────────────────────────────────────────────────────────────────────
FIELD: ground
──────────────────────────────────────────────────────────────────────────────
Raw format : integer or '?'
Output     : INTEGER, or NULL

Changes:
  '0'   →  0
  '5'   →  5
  '?'   →  NULL


──────────────────────────────────────────────────────────────────────────────
FIELD: summary
──────────────────────────────────────────────────────────────────────────────
Raw format : free-text description, may contain newlines/tabs and repeated punctuation
Output     : TEXT (normalised), or NULL

Changes:
  Text with '\n' or '\t'     →  replaced with a single space
  Multiple consecutive spaces →  collapsed to one space
  '..'  (repeated periods)   →  '.'
  '?'                        →  NULL
